pi=[0:0.01:1]

//GLeakage Conditional Vulnerability Function
function [Vp]= Vp(pi,pi2)
    if pi+pi2>1 then
        Vp=0;
    else
    p= [pi pi2 (1-pi-pi2)]
    //sum for all output Y
    Vp=0;
    [n,i]= size (C);
    for y=1:i
    //test for all the guesses W
    [m,i]= size (g);
    r= zeros(n,1);
    for w=1:m 
    //sum for all the inputs X
    for x=1:n
       r(w)=r(w)+p(x)*g(w,x)*C(x,y);
      // continue;
    end
    //continue;
    end
    
    //take the maximum w and sum
    Vp= Vp+ max(r);
    //continue;
    end
end
endfunction

//MinEntropy Conditional Vulnerability Function
function [Vpm]= Vpm(pi,pi2)
    if pi+pi2>1 then
        Vpm=0;
    else
        p= [pi pi2 (1-pi-pi2)]
        //sum for all output Y
        Vp=0;
        [n,i]= size (C);
        for y=1:i
            r= zeros(n,1);
            //for all the inputs X
            for x=1:n
               r(w)=p(x)*C(x,y);
            end
            
            //take the maximum w and sum
            Vpm= Vpm+ max(r);
        end
    end
endfunction